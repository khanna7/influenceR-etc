<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
  font: 10px sans-serif;
}

#plot {
  margin: auto;
  position: absolute;
  top: 0; bottom: 0; left: 0; right: 0;
  border: solid grey 1px;
}


</style>
<body>
  <div id="plot">
  </div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
<script src="util.js"></script>
<script src="graphCanvas.js"></script>
<script>
var width = 0.9*window.innerWidth, height = 0.9*window.innerHeight;
d3.select("#plot")
  .style({width: width+"px", height: height+"px"})


d3.csv("matchnet.csv", function(csv_links) { 
  /* specific to this */
  var links = []
  for (d of csv_links) {
    //d.source = d["UniqueID1"]
    //d.target = d["ParentUniqueID1"] // these guys are egos
    var id = d["UniqueID1"]
    var parent = d["ParentUniqueID1"]
    var recruiter = d["UniqueID1_recruiter"]
    links.push({source: id, target: parent, type: "parent"})
    if (recruiter != "")
      links.push({source: id, target: recruiter, type: "recruiter"})
  }
  
  var nodes = nodesFromLinks(links)
  
  var color = d3.scale.linear()
    .domain([0,1])
    .range(["red", "blue"])
  
  for (d of nodes)
    d.color = color(d.targetCount / (d.sourceCount + d.targetCount))
    
  for (d of links)
    d.color = d.type=="parent" ? "black" : "green";
  
  var plot = graphCanvas()
    .nodes(nodes)
    .edges(links)
  
  d3.select("#plot").call(plot)
  
  plot.start()
  
})

</script>